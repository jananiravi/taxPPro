<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Explore taxid data â€¢ taxPPro</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Explore taxid data">
<meta property="og:description" content="taxPPro">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">taxPPro</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/taxPPro.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/explore_taxids.html">Explore taxid data</a>
    </li>
    <li>
      <a href="../articles/propagation_workflow.html">Propagation workflow for categorical/logical attributes</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sdgamboa/taxPPro/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="explore_taxids_files/htmlwidgets-1.6.2/htmlwidgets.js"></script><link href="explore_taxids_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="explore_taxids_files/datatables-binding-0.29/datatables.js"></script><link href="explore_taxids_files/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="explore_taxids_files/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="explore_taxids_files/dt-core-1.13.4/js/jquery.dataTables.min.js"></script><link href="explore_taxids_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="explore_taxids_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Explore taxid data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sdgamboa/taxPPro/blob/HEAD/vignettes/articles/explore_taxids.Rmd" class="external-link"><code>vignettes/articles/explore_taxids.Rmd</code></a></small>
      <div class="hidden name"><code>explore_taxids.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sdgamboa/taxPPro" class="external-link">taxPPro</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/bugphyzz" class="external-link">bugphyzz</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="co"># taxizedb::db_download_ncbi(verbose = TRUE, overwrite = TRUE)</span></span></code></pre></div>
<div class="section level2">
<h2 id="ncbi-sets">NCBI sets<a class="anchor" aria-label="anchor" href="#ncbi-sets"></a>
</h2>
<p>We need a set of taxa in the NCBI to 1) use as a reference to
calculate completeness and 2) to create a tree data structure for
propagation.</p>
<p>The sets are based on the options given at the NCBI taxonomy
statistics page: <a href="https://www.ncbi.nlm.nih.gov/Taxonomy/taxonomyhome.html/index.cgi?chapter=statistics&amp;unclassified=hide&amp;uncultured=hide&amp;period=&amp;from=&amp;to=" class="external-link">NCBI
Taxonomy Statistics page</a>.</p>
<p>For convenience these sets were downloaded and included in the
extdata directory of the current package (<code>taxPPro</code>):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_ranks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'genus'</span>, <span class="st">'species'</span>, <span class="st">'strain'</span><span class="op">)</span></span>
<span><span class="va">dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, package <span class="op">=</span> <span class="st">'taxPPro'</span><span class="op">)</span></span>
<span><span class="va">fnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">dir</span>, pattern <span class="op">=</span> <span class="st">'proc_(exclude|include).*.txt'</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">taxids_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">'list'</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fnames</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">taxids_ls</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">taxids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">fnames</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">taxids_ls</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">'^.*/proc_(.*)_[0-9]*\\.txt'</span>, <span class="st">'\\1'</span>, <span class="va">fnames</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">ranks</span> <span class="op">&lt;-</span> <span class="fu">taxizedb</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/taxizedb/reference/taxid2rank.html" class="external-link">taxid2rank</a></span><span class="op">(</span><span class="va">taxids</span>, db <span class="op">=</span> <span class="st">'ncbi'</span><span class="op">)</span></span>
<span>  <span class="va">taxids_ls</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>taxid <span class="op">=</span> <span class="va">taxids</span>, rank <span class="op">=</span> <span class="va">ranks</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">rank</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">my_ranks</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Warning in taxizedb::taxid2rank(taxids, db = "ncbi"): No rank found for 16 of</span></span>
<span><span class="co">#&gt; 34642 taxon IDs. The followings are left unrankd: 1400058, 1573059, 1763447,</span></span>
<span><span class="co">#&gt; 1963271, 1968878, 1968882, 2211268, 2751472, 2817139, 2823376, 2837505,</span></span>
<span><span class="co">#&gt; 3037992, 3038074, 393617, 67334, 759360</span></span>
<span><span class="co">#&gt; Warning in taxizedb::taxid2rank(taxids, db = "ncbi"): No rank found for 34 of</span></span>
<span><span class="co">#&gt; 42982 taxon IDs. The followings are left unrankd: 1297800, 1400058, 1573059,</span></span>
<span><span class="co">#&gt; 1739785, 1763447, 1763448, 1963271, 1968878, 1968882, 2093796, 2211268,</span></span>
<span><span class="co">#&gt; 2623658, 2627207, 2629579, 2643532, 2644231, 2678888, 2751472, 2771474,</span></span>
<span><span class="co">#&gt; 2817139, 2817140, 2817142, 2823376, 2837505, 2847319, 2858887, 2904534,</span></span>
<span><span class="co">#&gt; 2993938, 3018742, 3037992, 3038074, 393617, 67334, 759360</span></span>
<span><span class="co">#&gt; Warning in taxizedb::taxid2rank(taxids, db = "ncbi"): No rank found for 28 of</span></span>
<span><span class="co">#&gt; 139062 taxon IDs. The followings are left unrankd: 1297800, 1297801, 1400058,</span></span>
<span><span class="co">#&gt; 1573059, 1739785, 1739786, 1763447, 1763448, 1763449, 1928915, 1963271,</span></span>
<span><span class="co">#&gt; 1968878, 1968882, 2211268, 2751472, 2817139, 2817142, 2817143, 2823376,</span></span>
<span><span class="co">#&gt; 2837505, 2904534, 2904535, 3037992, 3038074, 393617, 549795, 67334, 759360</span></span>
<span><span class="co">#&gt; Warning in taxizedb::taxid2rank(taxids, db = "ncbi"): No rank found for 21 of</span></span>
<span><span class="co">#&gt; 38507 taxon IDs. The followings are left unrankd: 1297800, 1400058, 1573059,</span></span>
<span><span class="co">#&gt; 1739785, 1763447, 1763448, 1963271, 1968878, 1968882, 2211268, 2751472,</span></span>
<span><span class="co">#&gt; 2817139, 2817142, 2823376, 2837505, 2904534, 3037992, 3038074, 393617, 67334,</span></span>
<span><span class="co">#&gt; 759360</span></span>
<span><span class="co">#&gt; Warning in taxizedb::taxid2rank(taxids, db = "ncbi"): No rank found for 18 of</span></span>
<span><span class="co">#&gt; 86083 taxon IDs. The followings are left unrankd: 1400058, 1573059, 1763447,</span></span>
<span><span class="co">#&gt; 1928915, 1963271, 1968878, 1968882, 2211268, 2751472, 2817139, 2823376,</span></span>
<span><span class="co">#&gt; 2837505, 3037992, 3038074, 393617, 549795, 67334, 759360</span></span>
<span><span class="co">#&gt; Warning in taxizedb::taxid2rank(taxids, db = "ncbi"): No rank found for 109 of</span></span>
<span><span class="co">#&gt; 505798 taxon IDs. The followings are left unrankd: 1301626, 1400058, 1419266,</span></span>
<span><span class="co">#&gt; 1573059, 1684659, 1763447, 1769156, 1769157, 1769158, 1783512, 1899020,</span></span>
<span><span class="co">#&gt; 1899428, 1928915, 1935118, 1935138, 1963271, 1963337, 1968878, 1968882,</span></span>
<span><span class="co">#&gt; 2024845, 2045443, 2093796, 2093797, 2211268, 2518984, 2615039, 2623658,</span></span>
<span><span class="co">#&gt; 2627207, 2629579, 2643532, 2644231, 2654172, 2654173, 2678888, 2709397,</span></span>
<span><span class="co">#&gt; 2730918, 2736876, 2736877, 2736878, 2736879, 2736880, 2736881, 2736882,</span></span>
<span><span class="co">#&gt; 2736883, 2736884, 2746320, 2751472, 2763046, 2764574, 2764575, 2764577,</span></span>
<span><span class="co">#&gt; 2764582, 2764594, 2771474, 2817139, 2817140, 2817141, 2817373, 2823376,</span></span>
<span><span class="co">#&gt; 2827029, 2837505, 2847319, 2858887, 2879649, 2881259, 2881270, 2881273,</span></span>
<span><span class="co">#&gt; 2881274, 2881275, 2881277, 2881278, 2885265, 2885349, 2885350, 2885355,</span></span>
<span><span class="co">#&gt; 2885359, 2912189, 2927225, 2935778, 2935781, 2935782, 2935783, 2935784,</span></span>
<span><span class="co">#&gt; 2935785, 2935789, 2950376, 2950378, 2962770, 2984200, 2984201, 2984202,</span></span>
<span><span class="co">#&gt; 2984203, 2984204, 2984205, 2991419, 2991710, 2993938, 2995302, 2995307,</span></span>
<span><span class="co">#&gt; 3015310, 3016894, 3018742, 3029201, 3037992, 3038074, 393617, 549795, 67334,</span></span>
<span><span class="co">#&gt; 759360</span></span>
<span><span class="co">#&gt; Warning in taxizedb::taxid2rank(taxids, db = "ncbi"): No rank found for 29 of</span></span>
<span><span class="co">#&gt; 39102 taxon IDs. The followings are left unrankd: 1400058, 1573059, 1763447,</span></span>
<span><span class="co">#&gt; 1963271, 1968878, 1968882, 2093796, 2211268, 2623658, 2627207, 2629579,</span></span>
<span><span class="co">#&gt; 2643532, 2644231, 2678888, 2751472, 2771474, 2817139, 2817140, 2823376,</span></span>
<span><span class="co">#&gt; 2837505, 2847319, 2858887, 2993938, 3018742, 3037992, 3038074, 393617, 67334,</span></span>
<span><span class="co">#&gt; 759360</span></span>
<span><span class="co">#&gt; Warning in taxizedb::taxid2rank(taxids, db = "ncbi"): No rank found for 119 of</span></span>
<span><span class="co">#&gt; 560210 taxon IDs. The followings are left unrankd: 1297800, 1297801, 1301626,</span></span>
<span><span class="co">#&gt; 1400058, 1419266, 1573059, 1684659, 1739785, 1739786, 1763447, 1763448,</span></span>
<span><span class="co">#&gt; 1763449, 1769156, 1769157, 1769158, 1783512, 1899020, 1899428, 1928915,</span></span>
<span><span class="co">#&gt; 1935118, 1935138, 1963271, 1963337, 1968878, 1968882, 2024845, 2045443,</span></span>
<span><span class="co">#&gt; 2093796, 2093797, 2211268, 2518984, 2615039, 2623658, 2627207, 2629579,</span></span>
<span><span class="co">#&gt; 2643532, 2644231, 2654172, 2654173, 2678888, 2709397, 2730918, 2736876,</span></span>
<span><span class="co">#&gt; 2736877, 2736878, 2736879, 2736880, 2736881, 2736882, 2736883, 2736884,</span></span>
<span><span class="co">#&gt; 2746320, 2751472, 2763046, 2764574, 2764575, 2764577, 2764582, 2764594,</span></span>
<span><span class="co">#&gt; 2771474, 2817139, 2817140, 2817141, 2817142, 2817143, 2817373, 2823376,</span></span>
<span><span class="co">#&gt; 2827029, 2837505, 2847319, 2858887, 2879649, 2881259, 2881270, 2881273,</span></span>
<span><span class="co">#&gt; 2881274, 2881275, 2881277, 2881278, 2885265, 2885349, 2885350, 2885355,</span></span>
<span><span class="co">#&gt; 2885359, 2904534, 2904535, 2912189, 2927225, 2935778, 2935781, 2935782,</span></span>
<span><span class="co">#&gt; 2935783, 2935784, 2935785, 2935789, 2950376, 2950378, 2962770, 2984200,</span></span>
<span><span class="co">#&gt; 2984201, 2984202, 2984203, 2984204, 2984205, 2991419, 2991710, 2993938,</span></span>
<span><span class="co">#&gt; 2995302, 2995307, 3015310, 3016894, 3018742, 3029201, 3037992, 3038074, 393617,</span></span>
<span><span class="co">#&gt; 549795, 67334, 759360</span></span>
<span><span class="va">taxids_summary</span> <span class="op">&lt;-</span> <span class="va">taxids_ls</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">'set'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">set</span>, <span class="va">rank</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">rank</span>, values_from <span class="op">=</span> <span class="va">n</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>total <span class="op">=</span> <span class="va">genus</span> <span class="op">+</span> <span class="va">species</span> <span class="op">+</span> <span class="va">strain</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">total</span>, <span class="va">set</span><span class="op">)</span></span>
<span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span></span>
<span>  <span class="va">taxids_summary</span>, </span>
<span>  caption <span class="op">=</span> <span class="st">'Table 1. Number of taxa per rank and NCBI set.'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-4a40f79b02d901e41d5f" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4a40f79b02d901e41d5f">{"x":{"filter":"none","vertical":false,"caption":"<caption>Table 1. Number of taxa per rank and NCBI set.<\/caption>","data":[["1","2","3","4","5","6","7","8"],["exclude_all","exclude_informal","exclude_unclassified_informal","exclude_uncultured_informal","exclude_unclassified_uncultured","exclude_unclassified","exclude_uncultured","include_all"],[5332,5332,5332,5332,5332,5332,5332,5332],[26151,26151,26151,26151,31789,80762,446698,497089],[0,0,0,0,42148,42273,42286,42411],[31483,31483,31483,31483,79269,128367,494316,544832]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>set<\/th>\n      <th>genus<\/th>\n      <th>species<\/th>\n      <th>strain<\/th>\n      <th>total<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="percentage-of-bugphyzz-taxids-annotated-in-the-ncbi">Percentage of bugphyzz taxids annotated in the NCBI:<a class="anchor" aria-label="anchor" href="#percentage-of-bugphyzz-taxids-annotated-in-the-ncbi"></a>
</h2>
<p>Get a nested list of the sets of NCBI taxids:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">taxids_ls2</span> <span class="op">&lt;-</span> <span class="va">taxids_ls</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">rank</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_depth.html" class="external-link">map_depth</a></span><span class="op">(</span>.depth <span class="op">=</span> <span class="fl">2</span>, .f <span class="op">=</span> <span class="op">~</span><span class="va">.x</span><span class="op">$</span><span class="va">taxid</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">taxids_ls2</span>, max.level <span class="op">=</span> <span class="fl">2</span>, vec.len <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 8</span></span>
<span><span class="co">#&gt;  $ exclude_all                    :List of 2</span></span>
<span><span class="co">#&gt;   ..$ genus  : int [1:5332] 10 1000999 ...</span></span>
<span><span class="co">#&gt;   ..$ species: int [1:26151] 100 100053 ...</span></span>
<span><span class="co">#&gt;  $ exclude_informal               :List of 2</span></span>
<span><span class="co">#&gt;   ..$ genus  : int [1:5332] 10 1000999 ...</span></span>
<span><span class="co">#&gt;   ..$ species: int [1:26151] 100 100053 ...</span></span>
<span><span class="co">#&gt;  $ exclude_unclassified           :List of 3</span></span>
<span><span class="co">#&gt;   ..$ genus  : int [1:5332] 10 1000999 ...</span></span>
<span><span class="co">#&gt;   ..$ species: int [1:80762] 100 1000028 ...</span></span>
<span><span class="co">#&gt;   ..$ strain : int [1:42273] 1000560 1000561 ...</span></span>
<span><span class="co">#&gt;  $ exclude_unclassified_informal  :List of 2</span></span>
<span><span class="co">#&gt;   ..$ genus  : int [1:5332] 10 1000999 ...</span></span>
<span><span class="co">#&gt;   ..$ species: int [1:26151] 100 100053 ...</span></span>
<span><span class="co">#&gt;  $ exclude_unclassified_uncultured:List of 3</span></span>
<span><span class="co">#&gt;   ..$ genus  : int [1:5332] 10 1000999 ...</span></span>
<span><span class="co">#&gt;   ..$ species: int [1:31789] 100 100053 ...</span></span>
<span><span class="co">#&gt;   ..$ strain : int [1:42148] 1000560 1000561 ...</span></span>
<span><span class="co">#&gt;  $ exclude_uncultured             :List of 3</span></span>
<span><span class="co">#&gt;   ..$ genus  : int [1:5332] 10 1000999 ...</span></span>
<span><span class="co">#&gt;   ..$ species: int [1:446698] 100 100000 ...</span></span>
<span><span class="co">#&gt;   ..$ strain : int [1:42286] 1000560 1000561 ...</span></span>
<span><span class="co">#&gt;  $ exclude_uncultured_informal    :List of 2</span></span>
<span><span class="co">#&gt;   ..$ genus  : int [1:5332] 10 1000999 ...</span></span>
<span><span class="co">#&gt;   ..$ species: int [1:26151] 100 100053 ...</span></span>
<span><span class="co">#&gt;  $ include_all                    :List of 3</span></span>
<span><span class="co">#&gt;   ..$ genus  : int [1:5332] 10 1000999 ...</span></span>
<span><span class="co">#&gt;   ..$ species: int [1:497089] 100 100000 ...</span></span>
<span><span class="co">#&gt;   ..$ strain : int [1:42411] 1000560 1000561 ...</span></span></code></pre></div>
<p>Import bugphyzz physiologies:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugphyzz/man/physiologies.html" class="external-link">physiologies</a></span><span class="op">(</span>full_source <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Missing columns in biosafety level. Missing columns are: Accession_ID</span></span>
<span><span class="co">#&gt; Warning: Missing columns in country. Missing columns are: Accession_ID</span></span>
<span><span class="co">#&gt; Warning: Missing columns in geographic location. Missing columns are:</span></span>
<span><span class="co">#&gt; Accession_ID</span></span>
<span><span class="co">#&gt; Warning: Missing columns in halophily. Missing columns are: Accession_ID</span></span>
<span><span class="co">#&gt; Warning: Missing columns in hemolysis. Missing columns are: Accession_ID</span></span>
<span><span class="co">#&gt; Warning: Missing columns in metabolite utilization. Missing columns are:</span></span>
<span><span class="co">#&gt; Accession_ID</span></span>
<span></span>
<span><span class="co">#&gt; Warning: Missing columns in metabolite utilization. Missing columns are:</span></span>
<span><span class="co">#&gt; Accession_ID</span></span>
<span><span class="co">#&gt; Warning: Missing columns in motility. Missing columns are: Accession_ID</span></span>
<span><span class="co">#&gt; Warning: Missing columns in pathogenicity human. Missing columns are:</span></span>
<span><span class="co">#&gt; Accession_ID</span></span>
<span><span class="co">#&gt; Warning: Missing columns in spore formation. Missing columns are: Accession_ID</span></span></code></pre></div>
<p>Create a list of bugphyzz taxids:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bp_ids</span> <span class="op">&lt;-</span> <span class="va">phys</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.x</span>, <span class="va">NCBI_ID</span> <span class="op">!=</span> <span class="st">'unknown'</span><span class="op">)</span>, <span class="va">NCBI_ID</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span>use.names <span class="op">=</span> <span class="cn">FALSE</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">bp_ranks</span> <span class="op">&lt;-</span> <span class="fu">taxizedb</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/taxizedb/reference/taxid2rank.html" class="external-link">taxid2rank</a></span><span class="op">(</span><span class="va">bp_ids</span>, db <span class="op">=</span> <span class="st">'ncbi'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in taxizedb::taxid2rank(bp_ids, db = "ncbi"): No rank found for 161 of</span></span>
<span><span class="co">#&gt; 17385 taxon IDs. The followings are left unrankd: 65497, 287094, 196083,</span></span>
<span><span class="co">#&gt; 136160, 513651, 1606016, 1646339, 126790, 1830421, 1400058, 165807, 134962,</span></span>
<span><span class="co">#&gt; 48937, 263820, 1311788, 342610, 166934, 1398496, 307251, 262776, 45461, 211759,</span></span>
<span><span class="co">#&gt; 244407, 332057, 332056, 46170, 68202, 84593, 62153, 109214, 1398560, 355929,</span></span>
<span><span class="co">#&gt; 1551, 1560, 861208, 86662, 469586, 469587, 665938, 469594, 340044, 335659,</span></span>
<span><span class="co">#&gt; 52765, 52766, 684949, 327817, 644968, 228748, 477693, 656024, 495036, 1345697,</span></span>
<span><span class="co">#&gt; 1166016, 741091, 147710, 931223, 420233, 195041, 68570, 93930, 140100, 675810,</span></span>
<span><span class="co">#&gt; 82076, 563191, 665937, 546899, 469595, 699245, 97139, 2274, 652712, 697871,</span></span>
<span><span class="co">#&gt; 796939, 796940, 36876, 1050843, 440512, 992010, 1267535, 1217705, 1217703,</span></span>
<span><span class="co">#&gt; 1217700, 981223, 1217697, 1217695, 1217702, 1217696, 1217706, 1217711, 1217698,</span></span>
<span><span class="co">#&gt; 1217712, 1217713, 520709, 903916, 1172, 196180, 690871, 62928, 640511, 330,</span></span>
<span><span class="co">#&gt; 911239, 658664, 998429, 861530, 366648, 220622, 1796653, 1217693, 1217710,</span></span>
<span><span class="co">#&gt; 1217709, 665945, 469596, 1121384, 1476577, 471821, 1849491, 1156433, 657310,</span></span>
<span><span class="co">#&gt; 671223, 319236, 1104325, 1834200, 1226298, 1182571, 1986224, 319938, 1546149,</span></span>
<span><span class="co">#&gt; 1662456, 1902251, 1662457, 595593, 1662458, 1126211, 1418110, 90270, 697046,</span></span>
<span><span class="co">#&gt; 1870930, 1570328, 1653479, 338187, 595500, 1418105, 1206652, 1206651, 1206650,</span></span>
<span><span class="co">#&gt; 1420890, 2834487, 1763447, 1331730, 265526, 67004, 2832, 5749, 29398, 35624,</span></span>
<span><span class="co">#&gt; 1206751, 376164, 40136, 1331737, 541003, 166974</span></span>
<span><span class="va">bp_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>taxid <span class="op">=</span> <span class="va">bp_ids</span>, rank <span class="op">=</span> <span class="va">bp_ranks</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">bp_ranks</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bp_ids_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">bp_df</span>, <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">bp_df</span><span class="op">$</span><span class="va">rank</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="op">{</span>\<span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">y</span>, <span class="op">~</span> <span class="va">.x</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">}</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="op">{</span>\<span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="va">y</span><span class="op">[</span><span class="va">my_ranks</span><span class="op">]</span><span class="op">}</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">bp_ids_ls</span>, vec.len <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ genus  : chr [1:1691] "291967" ...</span></span>
<span><span class="co">#&gt;  $ species: chr [1:9110] "105832" ...</span></span>
<span><span class="co">#&gt;  $ strain : chr [1:6231] "585394" ...</span></span></code></pre></div>
<p>Calculate percentage of bugphyzz taxa in every NCBI set:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myFun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">taxids_var</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">taxids_var</span><span class="op">)</span></span>
<span>  <span class="va">bp_subset</span> <span class="op">&lt;-</span> <span class="va">bp_ids_ls</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">taxids_var</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">per</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2_dbl</a></span><span class="op">(</span><span class="va">bp_subset</span>, <span class="va">taxids_var</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">.y</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">per</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'rank'</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">bp_ids_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">taxids_ls2</span>, <span class="va">myFun</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">'set'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">'rank'</span>, values_from <span class="op">=</span> <span class="st">'per'</span>, values_fill <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">taxids_summary</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'set'</span>, <span class="st">'total'</span><span class="op">)</span><span class="op">]</span>, by <span class="op">=</span> <span class="st">'set'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">total</span>, <span class="va">set</span><span class="op">)</span></span>
<span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span></span>
<span>  <span class="va">bp_ids_summary</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">'Table 2. Percentage of bugphyzz taxa also annotated in the NCBI sets per rank.'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-bbfc107f925fb6ec1c60" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-bbfc107f925fb6ec1c60">{"x":{"filter":"none","vertical":false,"caption":"<caption>Table 2. Percentage of bugphyzz taxa also annotated in the NCBI sets per rank.<\/caption>","data":[["1","2","3","4","5","6","7","8"],["exclude_all","exclude_informal","exclude_unclassified_informal","exclude_uncultured_informal","exclude_unclassified_uncultured","exclude_unclassified","exclude_uncultured","include_all"],[100,100,100,100,100,100,100,100],[70,70,70,70,71,71,99,99],[0,0,0,0,100,100,100,100],[31483,31483,31483,31483,79269,128367,494316,544832]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>set<\/th>\n      <th>genus<\/th>\n      <th>species<\/th>\n      <th>strain<\/th>\n      <th>total<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="creating-a-data-tree-stucture-based-on-strains-using-the-exclude-unclassified-and-uncultured-set">Creating a data.tree stucture based on strains using the exclude
unclassified and uncultured set<a class="anchor" aria-label="anchor" href="#creating-a-data-tree-stucture-based-on-strains-using-the-exclude-unclassified-and-uncultured-set"></a>
</h2>
<p>We could create a data.tree structure using the strains, but the
number of species is less. Maybe, because not all of the species have
strains in the NCBI.</p>
<p>All of the species with strains are represented in all of the NCBI
sets:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uu_strains</span> <span class="op">&lt;-</span> <span class="va">taxids_ls2</span><span class="op">$</span><span class="va">exclude_unclassified_uncultured</span><span class="op">$</span><span class="va">strain</span></span>
<span><span class="va">uu_strains_class</span> <span class="op">&lt;-</span> <span class="fu">taxizedb</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/taxizedb/reference/classification.html" class="external-link">classification</a></span><span class="op">(</span><span class="va">uu_strains</span>, db <span class="op">=</span> <span class="st">'ncbi'</span><span class="op">)</span></span>
<span><span class="va">uu_strains_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">uu_strains_class</span>, <span class="va">classif2Table</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">uu_strains_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">uu_strains_tbl</span><span class="op">$</span><span class="va">species</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">taxids_ls2</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">uu_strains_sp</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">.x</span><span class="op">$</span><span class="va">species</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $exclude_all</span></span>
<span><span class="co">#&gt; [1] 99</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exclude_informal</span></span>
<span><span class="co">#&gt; [1] 99</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exclude_unclassified</span></span>
<span><span class="co">#&gt; [1] 100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exclude_unclassified_informal</span></span>
<span><span class="co">#&gt; [1] 99</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exclude_unclassified_uncultured</span></span>
<span><span class="co">#&gt; [1] 100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exclude_uncultured</span></span>
<span><span class="co">#&gt; [1] 100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exclude_uncultured_informal</span></span>
<span><span class="co">#&gt; [1] 99</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $include_all</span></span>
<span><span class="co">#&gt; [1] 100</span></span></code></pre></div>
<p>But not the other way around. Species in the different NCBI sets
would not be fully represented in a tree constucted based on
strains:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">taxids_ls2</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">species</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">uu_strains_sp</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $exclude_all</span></span>
<span><span class="co">#&gt; [1] 23</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exclude_informal</span></span>
<span><span class="co">#&gt; [1] 23</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exclude_unclassified</span></span>
<span><span class="co">#&gt; [1] 8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exclude_unclassified_informal</span></span>
<span><span class="co">#&gt; [1] 23</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exclude_unclassified_uncultured</span></span>
<span><span class="co">#&gt; [1] 19</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exclude_uncultured</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exclude_uncultured_informal</span></span>
<span><span class="co">#&gt; [1] 23</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $include_all</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">## the percentage of include_all is so low because it includes so many more</span></span>
<span><span class="co">## species</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-a-tree-based-on-species-using-the-exlude_all-set">Create a tree based on species using the exlude_all set<a class="anchor" aria-label="anchor" href="#create-a-tree-based-on-species-using-the-exlude_all-set"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exall_sp</span> <span class="op">&lt;-</span> <span class="va">taxids_ls2</span><span class="op">$</span><span class="va">exclude_all</span><span class="op">$</span><span class="va">species</span></span>
<span><span class="va">exall_sp_class</span> <span class="op">&lt;-</span> <span class="fu">taxizedb</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/taxizedb/reference/classification.html" class="external-link">classification</a></span><span class="op">(</span><span class="va">exall_sp</span>, db <span class="op">=</span> <span class="st">'ncbi'</span><span class="op">)</span></span>
<span><span class="va">exall_sp_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">exall_sp_class</span>, <span class="va">classif2Table</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">exall_sp_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">exall_sp_tbl</span><span class="op">$</span><span class="va">species</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">taxids_ls2</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">exall_sp_sp</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">.x</span><span class="op">$</span><span class="va">species</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $exclude_all</span></span>
<span><span class="co">#&gt; [1] 100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exclude_informal</span></span>
<span><span class="co">#&gt; [1] 100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exclude_unclassified</span></span>
<span><span class="co">#&gt; [1] 100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exclude_unclassified_informal</span></span>
<span><span class="co">#&gt; [1] 100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exclude_unclassified_uncultured</span></span>
<span><span class="co">#&gt; [1] 100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exclude_uncultured</span></span>
<span><span class="co">#&gt; [1] 100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exclude_uncultured_informal</span></span>
<span><span class="co">#&gt; [1] 100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $include_all</span></span>
<span><span class="co">#&gt; [1] 100</span></span></code></pre></div>
<p>All parent species are included</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">uu_strains_sp</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">exall_sp_sp</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.9906296</span></span></code></pre></div>
<p>Can we get the same result getting children taxa from species?</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exall_sp_children</span> <span class="op">&lt;-</span> <span class="fu">taxizedb</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/taxizedb/reference/children.html" class="external-link">children</a></span><span class="op">(</span><span class="va">exall_sp_sp</span>, db <span class="op">=</span> <span class="st">'ncbi'</span><span class="op">)</span></span>
<span><span class="va">exall_sp_children</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">exall_sp_children</span>, <span class="op">~</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">exall_sp_children</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">exall_sp_children</span>, <span class="va">as.data.frame</span><span class="op">)</span></span>
<span><span class="va">exall_sp_children</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">exall_sp_children</span><span class="op">)</span></span>
<span><span class="va">exall_sp_children_strain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">exall_sp_children</span>, <span class="va">rank</span> <span class="op">==</span> <span class="st">'strain'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">taxids_ls2</span><span class="op">$</span><span class="va">exclude_unclassified_uncultured</span><span class="op">$</span><span class="va">strain</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">exall_sp_children_strain</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8620812</span></span></code></pre></div>
<p>The set exclude_unclassified_uncultured has the most coverage of
bugphyzz annotations:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">bp_ids_ls</span><span class="op">$</span><span class="va">strain</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">taxids_ls2</span><span class="op">$</span><span class="va">exclude_unclassified_uncultured</span><span class="op">$</span><span class="va">strain</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.9972717</span></span></code></pre></div>
<p>Getting chid strains from species in the exclude all seems a good
compromise. Still Most of the bugphyzz annotatiosn will be used.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">bp_ids_ls</span><span class="op">$</span><span class="va">strain</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">exall_sp_children_strain</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.9059541</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="final-comments">Final comments<a class="anchor" aria-label="anchor" href="#final-comments"></a>
</h2>
<p>No matter which phhylognetic or taxonomy tree is used, some bugphyzz
annotations will not be used for the propagation step. The best
compromise in size of the tree, performance, and number of bugphyzz
annotations used would be:</p>
<ul>
<li>Create a tree with the exclude all set using the species.</li>
<li>Use the taxizedb::children function to get child strains.</li>
<li>Add extra genera annotated in bugphyzz (if possible).</li>
<li>Add extra species annotated in bugphyzz (if possuible).</li>
<li>Add extra strains annotated in bugphyzz (if possible).</li>
<li>Save tree as a list in exported data.</li>
</ul>
<p>Note tha the steps above allow for polytomies, which would not be
possible with a phylogenetic tree and a formal ASR method.</p>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">â”€ Session info â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">setting </span> <span style="color: #555555; font-style: italic;">value</span></span></span>
<span><span class="co">#&gt;  version  R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">#&gt;  os       Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">#&gt;  system   x86_64, linux-gnu</span></span>
<span><span class="co">#&gt;  ui       X11</span></span>
<span><span class="co">#&gt;  language en</span></span>
<span><span class="co">#&gt;  collate  en_US.UTF-8</span></span>
<span><span class="co">#&gt;  ctype    en_US.UTF-8</span></span>
<span><span class="co">#&gt;  tz       Etc/UTC</span></span>
<span><span class="co">#&gt;  date     2023-09-06</span></span>
<span><span class="co">#&gt;  pandoc   3.1.1 @ /usr/local/bin/ (via rmarkdown)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">â”€ Packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">package    </span> <span style="color: #555555; font-style: italic;">*</span> <span style="color: #555555; font-style: italic;">version</span> <span style="color: #555555; font-style: italic;">date (UTC)</span> <span style="color: #555555; font-style: italic;">lib</span> <span style="color: #555555; font-style: italic;">source</span></span></span>
<span><span class="co">#&gt;  ape           5.7-1   <span style="color: #555555;">2023-03-13</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  bit           4.0.5   <span style="color: #555555;">2022-11-15</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  bit64         4.0.5   <span style="color: #555555;">2020-08-30</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  blob          1.2.4   <span style="color: #555555;">2023-03-17</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  bold          1.3.0   <span style="color: #555555;">2023-05-02</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  bslib         0.5.1   <span style="color: #555555;">2023-08-11</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  bugphyzz    * 0.0.1.4 <span style="color: #555555;">2023-09-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">Github (waldronlab/bugphyzz@12b671e)</span></span></span>
<span><span class="co">#&gt;  cachem        1.0.8   <span style="color: #555555;">2023-05-01</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  cli           3.6.1   <span style="color: #555555;">2023-03-23</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  codetools     0.2-19  <span style="color: #555555;">2023-02-01</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  conditionz    0.1.0   <span style="color: #555555;">2019-04-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  crayon        1.5.2   <span style="color: #555555;">2022-09-29</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  crosstalk     1.2.0   <span style="color: #555555;">2021-11-04</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  crul          1.4.0   <span style="color: #555555;">2023-05-17</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  curl          5.0.2   <span style="color: #555555;">2023-08-14</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  data.table    1.14.8  <span style="color: #555555;">2023-02-17</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  DBI           1.1.3   <span style="color: #555555;">2022-06-18</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  dbplyr        2.3.3   <span style="color: #555555;">2023-07-07</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  desc          1.4.2   <span style="color: #555555;">2022-09-08</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  digest        0.6.33  <span style="color: #555555;">2023-07-07</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  dplyr       * 1.1.3   <span style="color: #555555;">2023-09-03</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  DT            0.29    <span style="color: #555555;">2023-08-29</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  ellipsis      0.3.2   <span style="color: #555555;">2021-04-29</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  evaluate      0.21    <span style="color: #555555;">2023-05-05</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  fansi         1.0.4   <span style="color: #555555;">2023-01-22</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  fastmap       1.1.1   <span style="color: #555555;">2023-02-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  foreach       1.5.2   <span style="color: #555555;">2022-02-02</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  fs            1.6.3   <span style="color: #555555;">2023-07-20</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  generics      0.1.3   <span style="color: #555555;">2022-07-05</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  glue          1.6.2   <span style="color: #555555;">2022-02-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  hms           1.1.3   <span style="color: #555555;">2023-03-21</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  hoardr        0.5.3   <span style="color: #555555;">2023-01-26</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  htmltools     0.5.6   <span style="color: #555555;">2023-08-10</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  htmlwidgets   1.6.2   <span style="color: #555555;">2023-03-17</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  httpcode      0.3.0   <span style="color: #555555;">2020-04-10</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  iterators     1.0.14  <span style="color: #555555;">2022-02-05</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  jquerylib     0.1.4   <span style="color: #555555;">2021-04-26</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  jsonlite      1.8.7   <span style="color: #555555;">2023-06-29</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  knitr         1.43    <span style="color: #555555;">2023-05-25</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  lattice       0.21-8  <span style="color: #555555;">2023-04-05</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  lifecycle     1.0.3   <span style="color: #555555;">2022-10-07</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  magrittr      2.0.3   <span style="color: #555555;">2022-03-30</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  memoise       2.0.1   <span style="color: #555555;">2021-11-26</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  mgsub         1.7.3   <span style="color: #555555;">2021-07-28</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  nlme          3.1-163 <span style="color: #555555;">2023-08-09</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  pillar        1.9.0   <span style="color: #555555;">2023-03-22</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  pkgconfig     2.0.3   <span style="color: #555555;">2019-09-22</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  pkgdown       2.0.7   <span style="color: #555555;">2022-12-14</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  purrr       * 1.0.2   <span style="color: #555555;">2023-08-10</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  R6            2.5.1   <span style="color: #555555;">2021-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  ragg          1.2.5   <span style="color: #555555;">2023-01-12</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  rappdirs      0.3.3   <span style="color: #555555;">2021-01-31</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  Rcpp          1.0.11  <span style="color: #555555;">2023-07-06</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  readr         2.1.4   <span style="color: #555555;">2023-02-10</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  rlang         1.1.1   <span style="color: #555555;">2023-04-28</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  rmarkdown     2.24    <span style="color: #555555;">2023-08-14</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  rprojroot     2.0.3   <span style="color: #555555;">2022-04-02</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  RSQLite       2.3.1   <span style="color: #555555;">2023-04-03</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  sass          0.4.7   <span style="color: #555555;">2023-07-15</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  sessioninfo   1.2.2   <span style="color: #555555;">2021-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  stringi       1.7.12  <span style="color: #555555;">2023-01-11</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  stringr       1.5.0   <span style="color: #555555;">2022-12-02</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  systemfonts   1.0.4   <span style="color: #555555;">2022-02-11</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  taxize        0.9.100 <span style="color: #555555;">2022-04-22</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  taxizedb      0.3.1   <span style="color: #555555;">2023-04-03</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  taxPPro     * 0.1.0   <span style="color: #555555;">2023-09-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">local</span></span></span>
<span><span class="co">#&gt;  textshaping   0.3.6   <span style="color: #555555;">2021-10-13</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  tibble        3.2.1   <span style="color: #555555;">2023-03-20</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  tidyr       * 1.3.0   <span style="color: #555555;">2023-01-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  tidyselect    1.2.0   <span style="color: #555555;">2022-10-10</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  tzdb          0.4.0   <span style="color: #555555;">2023-05-12</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  utf8          1.2.3   <span style="color: #555555;">2023-01-31</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  uuid          1.1-1   <span style="color: #555555;">2023-08-17</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  vctrs         0.6.3   <span style="color: #555555;">2023-06-14</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  vroom         1.6.3   <span style="color: #555555;">2023-04-28</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  withr         2.5.0   <span style="color: #555555;">2022-03-03</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  xfun          0.40    <span style="color: #555555;">2023-08-09</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  xml2          1.3.5   <span style="color: #555555;">2023-07-06</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  yaml          2.3.7   <span style="color: #555555;">2023-01-23</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt;  zoo           1.8-12  <span style="color: #555555;">2023-04-13</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.3.1)</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [1] /usr/local/lib/R/site-library</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [2] /usr/local/lib/R/library</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Samuel Gamboa.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
